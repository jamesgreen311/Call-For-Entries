<script>
  document.addEventListener('DOMContentLoaded', pageLoaded);

  function pageLoaded() {
    let evtId = document.getElementById('btnSave').dataset.id;
    let evtName = document.getElementById('btnSave').dataset.name;
    google.script.run.withSuccessHandler(setCopyrightYear).getCurrentYear();
    google.script.run.withSuccessHandler(setMaxEntries).getMaxEntriesPerShow(evtId);
    google.script.run.withSuccessHandler(setMaxPerArtist).getMaxEntriesPerArtist(evtId);
    google.script.run.withSuccessHandler(setEntriesSubmitted).getTotalByEvent(evtName); 
    document.getElementById('emailAddress').addEventListener('change', checkMemberEmail);
    document.getElementById('imageFile').addEventListener("change", showThumbnail);
  }

  function setCopyrightYear(yr) {
    document.getElementById("copyrightYear").innerHTML = `Copyright &copy; ${yr}`;
  }

  function setMaxEntries(max) {
    document.getElementById("maxEntries").innerText = max;
  }

  function setMaxPerArtist(max) {
    document.getElementById("maxPerArtist").innerText = max;
  }

  function setEntriesSubmitted(count) {
    document.getElementById("entriesSubmitted").innerText = count;
  }

  function checkMemberEmail(el) {
    email = this.value;

    google.script.run.withSuccessHandler(showMemberSuccess).isMember(email);
  }

</script>