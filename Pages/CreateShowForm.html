<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
        integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous" />

    <title>Create a Show Form</title>
</head>

<body>
    <div class="container">
        <h4>New Show</h4>
        <form id="frmMain">
            <div class="form-group">
                <label for="exhibitName">Exhibit Name *</label>
                <input type="text" class="form-control" id="exhibitName" required></input>
            </div>

            <div class="form-group">
                <label for="shartDate">Start Date</label>
                <input type="datetime-local" class="form-control" id="startDate" />
            </div>

            <div class="form-group">
                <label class="form-check-label" for="closeDate">Close Date</label>
                <input type="datetime-local" class="form-control" id="closeDate" />
            </div>

            <div class="form-group">
                <label for="maxEntriesPerArtist">Max Entries per Artist *</label>
                <input type="number" class="form-control" id="maxEntriesPerArtist" min=1 required />
            </div>

            <div class="form-group">
                <label for="maxEntriesPerShow">Max Entries per Show</label>
                <input type="number" class="form-control" id="maxEntriesPerShow" min=1 />
            </div>

            <button type="button" class="btn btn-primary" id="btnSave">
                Save
            </button>
        </form>

        <div id="messageAlert" class="alert alert-success mt-4" role="alert" style="display: none;">
            <h4 class="alert-heading">Save Successful</h4>
            <p id="messageContent"></p>
            <hr>
            <p class="mb-0" id="messageFooter"></p>
        </div>
    </div>
    <script>
        document.getElementById("btnSave").addEventListener("click", saveShow);
        document.getElementById("frmMain").addEventListener("submit", stopSubmit);

        function saveFormSuccess(e) {
            let title = document.getElementById('titleOfWork').value;
            let footerMessage = `You can submit ${--uploadsLeft} more works for this exhibition.`;
            let messageContent = `Your submission: [${title}] has been saved. Would you like to submit another work?`;

            document.getElementById("loading").style.display = "none";
            document.getElementById("messageContent").innerHTML = messageContent;
            document.getElementById("messageFooter").innerHTML = footerMessage;

            /* reset field values here */

            container.style.display = "none";
        }

        function saveShow() {
            if (allFieldsValid()) {
                document.getElementById('messageAlert').style.display = "none";
                document.getElementById("loading").style.display = "block";
                google.script.run.withSuccessHandler(saveFormSuccess).saveFile(obj, data);
            } else {
                return false;
            }

            let show = {
                showId: 'generated',
                exhibitName: document.getElementById("exhibitName").value,
                startDate: document.getElementById("startDate").value,
                closeDate: document.getElementById("closeDate").value,
                maxEntriesPerArtist: document.getElementById("maxEntriesPerArtist").value,
                maxEntriesPerShow: document.getElementById("maxEntriesPerShow").value
            };
            google.script.run.withSuccessHandler(formSubmitted).addShowToSheet(show);
        }

        function formSubmitted(e) {
            //let title = document.getElementById('titleOfWork').value;
            //let footerMessage = `You can submit ${--uploadsLeft} more works for this exhibition.`;
            //let messageContent = `Your submission: [${title}] has been saved. Would you like to submit another work?`;

            let footerMessage = "Footer Content Message here";
            let messageContent = "Save successful message here";
            document.getElementById("loading").style.display = "none";
            document.getElementById("messageContent").innerHTML = messageContent;
            document.getElementById("messageFooter").innerHTML = footerMessage;

            /* reset field values here */
            document.getElementById("exhibitName").value = "";
            document.getElementById("startDate").value = "";
            document.getElementById("closeDate").value = "";
            document.getElementById("maxEntriesPerArtist").value = "";
            document.getElementById("maxEntriesPerShow").value = "";

            container.style.display = "none";
        }
    </script>
    <?!= include("Includes/global.script.inc"); ?>
</body>

</html>