<!DOCTYPE html>
<html lang="en">

<head>
    <base target="_top" />
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />

    <?!= include("Includes/css/mraa.inc"); ?>
    <?!= include("Includes/css/bootstrap-5.inc"); ?>
    <!-- Local Testing - Remove for remote -->
    <link rel="stylesheet" href="../Includes/css/mraa.inc.html">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css">
    <!-- Local Testing - Remove for remote -->

    <title>MRAA Exhibit Call For Entries Wizard</title>
</head>

<body>
    <button?!= include("Includes/html/header.inc"); ?>
        <!-- Local Testing - Remove for remote -->
        <header class="banner mt-2 p-3"><img
                src="https://metrorichmondart.org/wp-content/uploads/2020/02/cropped-mraa-logo-sm.png" alt="MRAA Logo">
        </header>
        <!-- Local Testing - Remove for remote -->


        <div class="container">
            <div class="row">
                <div class="col">
                    <ul class="nav nav-pills nav-fill mb-3" id="pills-tab" role="tablist">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link active" id="pills-artist-info-tab" data-bs-toggle="pill"
                                data-bs-target="#pills-artist-info" type="button" role="tab" aria-controls="pills-home"
                                aria-selected="true"><i class="bi bi-person-circle"></i>&nbsp;Artist Info</button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="pills-pay-fees-tab" data-bs-toggle="pill"
                                data-bs-target="#pills-pay-fees" type="button" role="tab" aria-controls="pills-pay-fees"
                                aria-selected="false"><i class="bi bi-credit-card"></i>
                                &nbsp;Pay Fees</button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="pills-upload-images-tab" data-bs-toggle="pill"
                                data-bs-target="#pills-upload-images" type="button" role="tab"
                                aria-controls="pills-upload-images" aria-selected="false"><i
                                    class="bi bi-cloud-arrow-up"></i>
                                &nbsp;Upload Images</button>
                        </li>
                    </ul>
                    <div class="tab-content" id="pills-tabContent">
                        <div class="tab-pane fade show active" id="pills-artist-info" role="tabpanel"
                            aria-labelledby="pills-artist-info-tab">
                            <form id="frmMain">
                                <div class="form-group">
                                    <label for="artistName">Artist Name *</label>
                                    <div class="input-group mb-3">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">First Name</span>
                                        </div>
                                        <input type="text" class="form-control" id="firstName" aria-label="First Name"
                                            required />
                                        <div class="invalid-feedback">First name is required</div>
                                        <div class="input-group-prepend ml-3">
                                            <span class="input-group-text">Last Name</span>
                                        </div>
                                        <input type="text" class="form-control" id="lastName" aria-label="Last Name"
                                            required />
                                        <div class="invalid-feedback">Last name is required</div>
                                    </div>
                                </div>

                                <label for="contactInfo">Contact Information *</label> <span id="memberStatus"
                                    class="badge"></span>
                                <div class="input-group mb-3">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text">Email</span>
                                    </div>
                                    <input type="email" class="form-control" id="emailAddress" aria-label="Email"
                                        placeholder="Enter a valid email address" required />
                                    <div class="input-group-prepend ml-3">
                                        <span class="input-group-text">Phone</span>
                                    </div>
                                    <input type="tel" class="form-control" id="phoneNumber" aria-label="Phone"
                                        required />
                                </div>

                                <div class="row mb-3">
                                    <div class="col-12">
                                        <!-- Buttons -->
                                        <hr>
                                        <div>
                                            <button class="btn btn-primary mraa-button-primary mr-3" data-id="<?= id ?>"
                                                data-folder="<?= imageFolderId ?>" data-name="<?= name ?>"
                                                id="btnNextPay">Next</button>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>

                        <div class="tab-pane fade" id="pills-pay-fees" role="tabpanel"
                            aria-labelledby="pills-pay-fees-tab">
                            <form action="https://www.paypal.com/cgi-bin/webscr" method="POST" target="_top">
                                <div class="content">
                                    <div class="container mt-4 mb-2">
                                        <div class="row text-center">
                                            <div class="tab-content" id="payFee">
                                                <form action="https://www.paypal.com/cgi-bin/webscr" method="POST"
                                                    target="_top">
                                                    <div class="content">
                                                        <div class="container mt-4 mb-2">
                                                            <div class="row text-center">

                                                                <div id="smart-button-container">
                                                                    <div class="col"></div>
                                                                    <div class="col">
                                                                        <header class="h1">
                                                                            Pay with PayPal
                                                                        </header>
                                                                        <div class="mb-4">
                                                                            <p>Select Number of Works to Exhibit</p>

                                                                            <select style="visibility: hidden"
                                                                                id="quantitySelect">
                                                                                <option value="1">1</option>
                                                                                <option value="2">2</option>
                                                                            </select>
                                                                            <select id="item-options">
                                                                                <option value="Per Item" price="10">Each
                                                                                    Item $10</option>
                                                                            </select>
                                                                        </div>
                                                                        <div id="paypal-button-container"></div>
                                                                    </div>
                                                                </div>
                                                                <div class="col"></div>

                                                            </div>


                                                        </div>
                                                    </div>
                                                </form>
                                            </div>
                                        </div>
                                        <div class="row mb-3">
                                            <div class="col-12">
                                                <!-- Buttons -->
                                                <hr>
                                                <div>
                                                    <button class="btn btn-primary mraa-button-primary mr-3"
                                                        data-id="<?= id ?>" data-folder="<?= imageFolderId ?>"
                                                        data-name="<?= name ?>" id="btnNextUpload">Next</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>

                        <!-- Upload Images Tab Content -->
                        <div class="tab-pane fade" id="pills-upload-images" role="tabpanel"
                            aria-labelledby="pills-upload-images-tab">
                            <div class="row">
                                <div class="col-6">
                                    <div class="mraa-callout mraa-callout-info">
                                        <h4>Select Your Images to Upload</h4>
                                        <div class="row mb-2">
                                            <div class="col-8"><strong>Limit of <span
                                                        id="maxPerArtist">Loading...</span> uploads per
                                                    Artist</strong></div>
                                            <div class="col-4 text-right">All fields required *</div>
                                        </div>
                                        <div class="form-group mb-3">
                                            <input accept="image/jpeg, image/png" type="file" id="imageFile"
                                                class="form-control-file" required onchange="showThumbnail(event)">
                                        </div>
                                        <div class="bigger"><strong>You have uploaded <span id="submitsByArtist"
                                                    class="badge badge-warning badge-bigger">0</span>
                                                images.</strong></div>
                                    </div>
                                    <!-- Title -->
                                    <div class="input-group mb-3">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">Title of Work</span>
                                        </div>
                                        <input type="text" class="form-control" id="titleOfWork"
                                            aria-label="Title of Work" required />
                                    </div>
                                    <div class="input-group">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">Width (in)</span>
                                        </div>
                                        <input type="number" class="form-control" id="sizeWidth"
                                            aria-label="Size: Width (in)" min="1" max="999" required />
                                        <div class="input-group-prepend ml-3">
                                            <span class="input-group-text">Height (in)</span>
                                        </div>
                                        <input type="number" class="form-control" id="sizeHeight"
                                            aria-label="Size: Height (in)" min="1" max="999" required />
                                    </div>
                                    <div class="smaller mb-3"><strong>Size should include the frame if artwork is
                                            framed</strong></div>
                                    <!-- Medium -->
                                    <div class="input-group mb-3">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">Medium</span>
                                        </div>
                                        <input type="text" class="form-control" id="medium" aria-label="Medium"
                                            required />
                                    </div>
                                    <!-- Price -->
                                    <div>
                                        <label for="price">Price *</label>
                                        <div class="input-group mb-3">
                                            <div class="input-group-prepend">
                                                <span class="input-group-text">$</span>
                                            </div>
                                            <div>
                                                <input type="number" class="form-control"
                                                    aria-label="Amount (to the nearest dollar)" id="price" size="10"
                                                    required />
                                            </div>
                                            <div class="input-group-append">
                                                <span class="input-group-text">.00</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <!-- Thumbnail -->
                                    <div id="thumbnail-outer-box" class="mraa-highlight p-3 mt-2">
                                        <h2 class="badge badge-secondary">Preview Area</h2>
                                        <div id="thumbnail-message" class="text-muted small m-3">
                                            <p>Once you have chosen an image to upload, it
                                                will appear here for you to preview before sending to MRAA.</p>
                                            <p>
                                                <strong class="mraa-important">IMPORTANT</strong>
                                            </p>
                                            <p>
                                                Your registration is <span class="mraa-important">NOT</span> saved
                                                until you fill out all required fields and press the <strong>Upload
                                                    Image</strong> button.
                                            </p>
                                            <p>Click the <strong>Finish and Exit</strong> button after all images
                                                have been uploaded.</p>
                                        </div>
                                        <div class="mraa-thumbnail-container" id="thumbnail-container"
                                            style="display: none;">
                                            <img class="mraa-thumbnail" id="thumbnail" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row mb-3">
                                <div class="col-12">
                                    <!-- Buttons -->
                                    <hr>
                                    <div>
                                        <button class="btn btn-primary mraa-button-primary mr-3" data-id="<?= id ?>"
                                            data-folder="<?= imageFolderId ?>" data-name="<?= name ?>"
                                            id="btnSave">Upload Image</button>
                                        <a class="btn btn-secondary mraa-button-secondary ml-3"
                                            href="<?= ScriptApp.getService().getUrl(); ?>?v=done" id="btnDone"
                                            target="_top">Finish</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>


        <?!= include("Includes/html/footer.inc"); ?>
        <!-- Local Testing - Remove for remote -->
        <footer class="footer">
            <div class="row">
                <div class="col-6">
                    <div class="mr-5">Metropolitan Richmond Artists Association</div>
                </div>
                <div class="col-6 text-right">
                    <small class="mr-5"> </small><span id="copyrightYear" class="text-muted smaller"></span>
                </div>
            </div>
        </footer>
        <!-- Local Testing - Remove for remote -->

        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"
            integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous">
        </script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"
            integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous">
        </script>

        <script src="https://www.paypal.com/sdk/js?client-id=sb&enable-funding=venmo&currency=USD"
            data-sdk-integration-source="button-factory"></script>
        <script>
            function initPayPalButton() {
                var shipping = 0;
                var itemOptions = document.querySelector("#smart-button-container #item-options");
                var quantity = parseInt(2);
                var quantitySelect = document.querySelector("#smart-button-container #quantitySelect");
                if (!isNaN(quantity)) {
                    quantitySelect.style.visibility = "visible";
                }
                var orderDescription = 'Select Number of Works to Exhibit';
                if (orderDescription === '') {
                    orderDescription = 'Item';
                }
                paypal.Buttons({
                    style: {
                        shape: 'rect',
                        color: 'gold',
                        layout: 'vertical',
                        label: 'pay',

                    },
                    createOrder: function (data, actions) {
                        var selectedItemDescription = itemOptions.options[itemOptions.selectedIndex].value;
                        var selectedItemPrice = parseFloat(itemOptions.options[itemOptions.selectedIndex]
                            .getAttribute("price"));
                        var tax = (0 === 0) ? 0 : (selectedItemPrice * (parseFloat(0) / 100));
                        if (quantitySelect.options.length > 0) {
                            quantity = parseInt(quantitySelect.options[quantitySelect.selectedIndex].value);
                        } else {
                            quantity = 1;
                        }

                        tax *= quantity;
                        tax = Math.round(tax * 100) / 100;
                        var priceTotal = quantity * selectedItemPrice + parseFloat(shipping) + tax;
                        priceTotal = Math.round(priceTotal * 100) / 100;
                        var itemTotalValue = Math.round((selectedItemPrice * quantity) * 100) / 100;

                        return actions.order.create({
                            purchase_units: [{
                                description: orderDescription,
                                amount: {
                                    currency_code: 'USD',
                                    value: priceTotal,
                                    breakdown: {
                                        item_total: {
                                            currency_code: 'USD',
                                            value: itemTotalValue,
                                        },
                                        shipping: {
                                            currency_code: 'USD',
                                            value: shipping,
                                        },
                                        tax_total: {
                                            currency_code: 'USD',
                                            value: tax,
                                        }
                                    }
                                },
                                items: [{
                                    name: selectedItemDescription,
                                    unit_amount: {
                                        currency_code: 'USD',
                                        value: selectedItemPrice,
                                    },
                                    quantity: quantity
                                }]
                            }]
                        });
                    },
                    onApprove: function (data, actions) {
                        return actions.order.capture().then(function (details) {
                            alert('Transaction completed by ' + details.payer.name.given_name +
                                '!');
                        });
                    },
                    onError: function (err) {
                        console.log(err);
                    },
                }).render('#paypal-button-container');
            }
            initPayPalButton();
        </script>
</body>

</html>